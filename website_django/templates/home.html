{% extends "base.html" %}
{% load static %}

{% block title %}SustainaCore | Open ESG & AI governance{% endblock %}
{% block meta_description %}Open ESG and AI governance data with TECH100 scores, curated news, and the Ask2 assistant from SustainaCore.{% endblock %}

{% block extra_head %}
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" defer></script>
{% endblock %}

{% block content %}
<section class="hero">
    <div class="shell hero__grid">
        <div class="hero__copy">
            <p class="eyebrow">Open ESG + AI governance</p>
            <h1>Evidence-based indicators for responsible technology.</h1>
            <p class="lead">SustainaCore brings together transparent data, reproducible indicators, and human context so teams can evaluate how technology companies govern AI responsibly.</p>
            <div class="actions">
                <a class="btn btn--primary" href="{% url 'tech100' %}">Explore TECH100</a>
                <a class="btn btn--ghost" href="{% url 'ask2:ask2_page' %}" aria-label="Talk to our Ask2 AI Assistant">Talk to our AI Assistant</a>
            </div>
            <ul class="hero__bullets">
                <li>Compare companies on transparency, accountability, and responsible deployment.</li>
                <li>Follow governance updates with curated news and evidence-backed signals.</li>
                <li>Ask questions in plain language with the Ask2 assistant.</li>
            </ul>
        </div>
        <div class="hero__card">
            <div class="hero__card-header">
                <div class="pill pill--soft hero__card-pill">TECH100 AI Index Snapshot</div>
                <div class="hero__card-title">Top 3 AI Governance &amp; Ethics scores</div>

            </div>
            <div class="list">
                {% for company in tech100_preview %}
                <div class="list__item">
                    <div>
                        <div class="list__title">{{ company.company }}</div>
                        <div class="list__meta">{{ company.sector }} · {{ company.region }}</div>
                    </div>
                    <div class="badge">{{ company.overall }}</div>
                </div>
                {% endfor %}
            </div>
            <a class="text-link" href="{% url 'tech100' %}">View the TECH100 index →</a>
        </div>
    </div>
</section>

<section class="section tech100-home">
    <div class="shell">
        <div class="section__header section__header--split">
            <div>
                <span class="pill pill--soft">TECH100 Index Snapshot</span>
                <h2>Performance at a glance</h2>
                <p class="muted">A compact view of index performance and data quality signals.</p>
            </div>
        </div>

        <div class="card tech100-entry">
            <span class="pill pill--soft">TECH100 AI Index Snapshot</span>
            <h3 class="h4">Explore TECH100 AI Governance &amp; Ethics</h3>
            <p class="muted">Navigate the full TECH100 experience with performance, constituents, and governance scores.</p>
            <div class="actions">
                <a class="btn btn--primary" href="/tech100/index/">View dashboard</a>
            </div>
            <div class="tech100-entry__links">
                <span class="muted">Quick links:</span>
                <a class="text-link" href="/tech100/performance/">Performance</a>
                <a class="text-link" href="/tech100/constituents/">Constituents</a>
                <a class="text-link" href="/tech100/">Governance</a>
            </div>
            <div class="tech100-entry__tools muted">
                Tools: <a class="text-link" href="/tech100/performance/export/?kind=holdings">Download holdings CSV</a>
            </div>
        </div>

        {% if tech100_snapshot.data_error %}
            <div class="alert alert--warning" data-tech100-home-empty="1">
                Live TECH100 data is temporarily unavailable; please try again later.
            </div>
        {% elif tech100_snapshot.has_data %}
            <div class="tech100-home__grid"
                 data-tech100-home-has-data="1"
                 data-level-count="{{ tech100_snapshot.levels_count }}"
                 data-real-count="{{ tech100_snapshot.quality_counts.REAL|default:0 }}"
                 data-imputed-count="{{ tech100_snapshot.quality_counts.IMPUTED|default:0 }}">
                <div class="card tech100-home__chart">
                    <div class="tech100-home__chart-header">
                        <div>
                            <h3 class="h4">Index level (3M)</h3>
                            <p class="muted">As of {{ tech100_snapshot.as_of }} (UTC)</p>
                        </div>
                        <div class="tech100-index__range tech100-home__range">
                            <button class="btn btn--ghost tech100-home-range is-active" data-range="3m">3M</button>
                            <button class="btn btn--ghost tech100-home-range" data-range="1m">1M</button>
                            <button class="btn btn--ghost tech100-home-range" data-range="6m">6M</button>
                            <button class="btn btn--ghost tech100-home-range" data-range="ytd">YTD</button>
                            <button class="btn btn--ghost tech100-home-range" data-range="1y">1Y</button>
                            <button class="btn btn--ghost tech100-home-range" data-range="max">Max</button>
                        </div>
                    </div>
                    <div class="tech100-home__canvas">
                        <canvas id="tech100-home-level-chart" role="img" aria-label="TECH100 index level chart"></canvas>
                    </div>
                </div>
                <div class="card tech100-home__stats">
                    <div class="tech100-home__stats-grid">
                        <div>
                            <p class="kpi-label">Latest level</p>
                            <p class="kpi-value">{{ tech100_snapshot.latest_level|default:"—"|floatformat:2 }}</p>
                        </div>
                        <div>
                            <p class="kpi-label">1D return</p>
                            <p class="kpi-value">{{ tech100_snapshot.ret_1d|default:"—"|floatformat:2 }}{% if tech100_snapshot.ret_1d %}%{% endif %}</p>
                        </div>
                        <div>
                            <p class="kpi-label">MTD return</p>
                            <p class="kpi-value">{{ tech100_snapshot.ret_mtd|default:"—"|floatformat:2 }}{% if tech100_snapshot.ret_mtd %}%{% endif %}</p>
                        </div>
                        <div>
                            <p class="kpi-label">YTD return</p>
                            <p class="kpi-value">{{ tech100_snapshot.ret_ytd|default:"—"|floatformat:2 }}{% if tech100_snapshot.ret_ytd %}%{% endif %}</p>
                        </div>
                        <div>
                            <p class="kpi-label">30D vol (ann.)</p>
                            <p class="kpi-value">{{ tech100_snapshot.vol_30d|default:"—"|floatformat:2 }}{% if tech100_snapshot.vol_30d %}%{% endif %}</p>
                        </div>
                        <div>
                            <p class="kpi-label">Max drawdown YTD</p>
                            <p class="kpi-value">{{ tech100_snapshot.drawdown_ytd|default:"—"|floatformat:2 }}{% if tech100_snapshot.drawdown_ytd %}%{% endif %}</p>
                        </div>
                    </div>
                    <div class="tech100-home__quality">
                        <span class="muted">Data quality</span>
                        <span class="pill pill--soft">REAL {{ tech100_snapshot.quality_counts.REAL|default:0 }}</span>
                        <span class="pill pill--soft pill--warning">IMPUTED {{ tech100_snapshot.quality_counts.IMPUTED|default:0 }}</span>
                    </div>
                </div>
            </div>
        {% else %}
            <div class="alert alert--warning" data-tech100-home-empty="1">
                No TECH100 index data found.
            </div>
        {% endif %}
    </div>
</section>

<section class="section">
    <div class="shell">
        <div class="section__header">
            <h2>What you can do with SustainaCore</h2>
            <p class="muted">Start with a clear overview, then dive into structured scores, curated news, and a guided assistant.</p>
        </div>
        <div class="cards cards--three">
            <div class="card">
                <p class="pill pill--soft">TECH100</p>
                <h3>Governance &amp; ethics index</h3>
                <p class="muted">Sortable, comparable scores across transparency, accountability, and oversight pillars.</p>
                <a class="btn btn--secondary" href="{% url 'tech100' %}">Open TECH100</a>
            </div>
            <div class="card">
                <p class="pill pill--soft">Ask2</p>
                <h3>AI assistant with evidence</h3>
                <p class="muted">Ask questions in natural language and get grounded answers sourced from the SustainaCore backend.</p>
                <a class="btn btn--secondary" href="{% url 'ask2:ask2_page' %}" aria-label="Chat with the Ask2 AI Assistant">Chat with Ask2</a>
            </div>
            <div class="card">
                <p class="pill pill--soft">News</p>
                <h3>AI governance headlines</h3>
                <p class="muted">Stay current on regulatory updates, transparency reports, and accountability signals.</p>
                <a class="btn btn--secondary" href="{% url 'news' %}">Browse news</a>
            </div>
        </div>
    </div>
</section>

<section class="section section--alt">
    <div class="shell">
        <div class="section__header">
            <h2>Methodology you can trust</h2>
            <p class="muted">Structured around public evidence, transparent scoring, and reproducible workflows.</p>
        </div>
        <div class="grid grid--three">
            <div class="card card--lined">
                <h4>Evidence-backed</h4>
                <p class="muted">Signals come from public disclosures, regulatory filings, and verifiable reports.</p>
            </div>
            <div class="card card--lined">
                <h4>Comparable metrics</h4>
                <p class="muted">Indicators align with transparency, accountability, and oversight themes for consistent benchmarking.</p>
            </div>
            <div class="card card--lined">
                <h4>Reproducible by design</h4>
                <p class="muted">Versioned methodologies and open data paths make it easier to audit, rerun, and extend.</p>
            </div>
        </div>
    </div>
</section>

<section class="section">
    <div class="shell">
        <div class="section__header section__header--split">
            <div>
                <h2>Latest from the TECH100</h2>
                <p class="muted">A snapshot of company scores before you dive into the full index.</p>
            </div>
            <a class="text-link" href="{% url 'tech100' %}">Open TECH100 →</a>
        </div>
        <div class="table" role="table" aria-label="TECH100 preview">
            <div class="table__row table__row--head" role="row">
                <div class="table__cell" role="columnheader">Company</div>
                <div class="table__cell" role="columnheader">Sector</div>
                <div class="table__cell" role="columnheader">Region</div>
                <div class="table__cell table__cell--right" role="columnheader">Overall</div>
            </div>
            {% for company in tech100_preview %}
            <div class="table__row" role="row">
                <div class="table__cell" role="cell">{{ company.company }}</div>
                <div class="table__cell" role="cell">{{ company.sector }}</div>
                <div class="table__cell" role="cell">{{ company.region }}</div>
                <div class="table__cell table__cell--right" role="cell">
                    <span class="badge">{{ company.overall }}</span>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<section class="section section--alt">
    <div class="shell">
        <div class="section__header section__header--split">
            <div>
                <h2>News &amp; insights</h2>
                <p class="muted">Curated headlines on AI governance, ESG transparency, and regulatory moves.</p>
            </div>
            <a class="text-link" href="{% url 'news' %}">See all news →</a>
        </div>
        <div class="cards cards--list">
            {% for item in news_preview %}
            <article class="news-card">
                <div class="news-card__meta">{{ item.source }} · {{ item.published_at|date:"M j, Y" }}</div>
                <h3 class="news-card__title">{{ item.title }}</h3>
                <p class="muted">{{ item.summary }}</p>
                <div class="news-card__tags">
                    {% for tag in item.tags %}
                    <span class="tag">{{ tag }}</span>
                    {% endfor %}
                </div>
            </article>
            {% endfor %}
        </div>
    </div>
</section>
{{ tech100_snapshot.levels|default:"[]"|json_script:"tech100-home-levels" }}
{% endblock %}

{% block extra_scripts %}
  <script src="{% static 'js/tech100-index.js' %}" defer></script>
{% endblock %}
